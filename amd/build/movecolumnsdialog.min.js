define("mod_board/movecolumnsdialog",["exports","core/modal_cancel","core/modal_events","core/notification","core/str"],(function(_exports,_modal_cancel,_modal_events,_notification,Str){function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_modal_cancel=_interopRequireDefault(_modal_cancel),_modal_events=_interopRequireDefault(_modal_events),_notification=_interopRequireDefault(_notification),Str=function(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj,cache&&cache.set(obj,newObj);return newObj}(Str);const getDestinationsList=moveColumnControl=>{const columns=document.querySelectorAll(".mod_board .board_column"),currentColumn=moveColumnControl.closest(".board_column"),columnsArray=Array.from(columns);let sortorder=columnsArray.indexOf(currentColumn);const wrapper=document.createElement("div"),list=document.createElement("ul");return list.classList.add("move-column-dialog-destinations","list-unstyled"),Str.get_string("move_column_to_firstplace","mod_board").then((moveToFirstString=>{if(0!==sortorder){const li=document.createElement("li"),link=moveLink(currentColumn.dataset.ident,0,moveToFirstString);li.appendChild(link),list.appendChild(li)}return columns.forEach((column=>{const sortOrder=columnsArray.indexOf(column);if(currentColumn==column)return;const columnName=column.querySelector(".mod_board_column_name").innerText;Str.get_string("move_column_to_aftercolumn","mod_board",columnName).then((moveToColumnString=>{const li=document.createElement("li"),link=moveLink(currentColumn.dataset.ident,sortOrder,moveToColumnString);return li.appendChild(link),list.appendChild(li),""})).catch(_notification.default.exception)})),wrapper.appendChild(list),""})).catch(_notification.default.exception),wrapper.appendChild(list),wrapper},moveLink=(movingColumnId,sortOrder,linkString)=>{const link=document.createElement("a");return link.setAttribute("href","#"),link.dataset.movingcolumnid=movingColumnId,link.dataset.sortorder=sortOrder,link.innerText=linkString,link},displayMoveModal=moveColumnControl=>{const modalTitle=moveColumnControl.getAttribute("aria-label");_modal_cancel.default.create({title:modalTitle,body:getDestinationsList(moveColumnControl)}).then((modal=>(modal.getRoot().on(_modal_events.default.hidden,(()=>{modal.destroy()})),document.addEventListener("closemovedialog",(()=>{modal.destroy()})),modal.show(),modal))).catch(_notification.default.exception)};var _default={init:moveColumn=>{const body=document.querySelector("body");body.classList.contains("move-column-dialog-initialized")||(document.addEventListener("click",(e=>{const moveColumnControl=e.target.closest(".mod_column_move");moveColumnControl&&displayMoveModal(moveColumnControl);const moveDestination=e.target.closest(".move-column-dialog-destinations a");if(moveDestination){e.preventDefault();let payload={id:parseInt(moveDestination.dataset.movingcolumnid),sortorder:parseInt(moveDestination.dataset.sortorder)};moveColumn(payload),document.dispatchEvent(new Event("closemovedialog"))}})),document.addEventListener("keypress",(e=>{const moveColumnControl=e.target.closest(".mod_column_move");moveColumnControl&&displayMoveModal(moveColumnControl)})),body.classList.add("move-column-dialog-initialized"))}};return _exports.default=_default,_exports.default}));

//# sourceMappingURL=movecolumnsdialog.min.js.map